// Generated by CoffeeScript 2.7.0
import {
  echo,
  global,
  range,
  settings
} from './global.js';

import {
  performance
} from './rating.js';

export var Player = class Player {
  constructor(id, name, elo1) {
    this.id = id;
    this.name = name;
    this.elo = elo1;
    this.fideid = "1712345";
    this.born = "0000";
    this.federation = "   ";
    this.sex = " ";
    this.title = "   ";
    this.opp = []; // används endast av Floating
    this.col = ""; // används endast av Floating
    this.summa = 0;
    this.P = 0;
    this.PR = 0;
  }

  balance() {
    var b, c, j, len, ref;
    b = 0;
    ref = this.col;
    for (j = 0, len = ref.length; j < len; j++) {
      c = ref[j];
      if (c === 'w') {
        b++;
      }
      if (c === 'b') {
        b--;
      }
    }
    return b;
  }

  toString() {
    return `${String(this.elo).padStart(4, '0')} ${this.name}`;
  }

  getElos(long) {
    var ch, elo, j, len, opp, r, ref, value;
    this.P = 0;
    this.PR = 0;
    this.elos = [this.elo, ':'];
    ref = range(settings.GAMES * settings.ROUNDS);
    for (j = 0, len = ref.length; j < len; j++) {
      r = ref[j];
      ch = long[r][3];
      value = '012'.indexOf(ch);
      opp = long[r][1];
      if (value !== -1) {
        elo = global.players[opp].elo;
        this.P += value / 2;
        if (elo !== 0) {
          this.PR += value / 2;
          this.elos.push(Math.round(elo));
        }
      } else {
        this.elos.push('    ');
      }
    }
    this.elos.push(this.PR);
    return this.elos.join(' ');
  }

  update_P_and_PR(longs, i) {
    var andel, ch, elo, j, len, long, opp, perf, r, ref, value;
    long = longs[i];
    //echo 'longs',longs
    this.P = 0;
    this.PR = 0;
    this.elos = [];
    ref = range(settings.GAMES * settings.ROUNDS);
    for (j = 0, len = ref.length; j < len; j++) {
      r = ref[j];
      ch = long[r][3];
      value = '012'.indexOf(ch);
      opp = long[r][1];
      if (value !== -1) {
        elo = global.players[opp].elo;
        this.P += value / 2;
        if (elo !== 0) {
          this.PR += value / 2;
          this.elos.push(Math.round(elo));
        }
      }
    }
    // kalkylera performance rating mha vinstandel och elo-tal
    if (this.elos.length === 0) {
      return this.PR = 0;
    } else {
      andel = this.PR;
      perf = performance(andel, this.elos);
      return this.PR = perf;
    }
  }

};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGxheWVyLmpzIiwic291cmNlUm9vdCI6IlxcIiwic291cmNlcyI6WyJwbGF5ZXIuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFBO0VBQVEsSUFBUjtFQUFhLE1BQWI7RUFBb0IsS0FBcEI7RUFBMEIsUUFBMUI7Q0FBQSxNQUFBOztBQUNBLE9BQUE7RUFBUSxXQUFSO0NBQUEsTUFBQTs7QUFFQSxPQUFBLElBQWEsU0FBTixNQUFBLE9BQUE7RUFFTixXQUFjLEdBQUEsTUFBQSxNQUFBLENBQUE7SUFBQyxJQUFDLENBQUE7SUFBSSxJQUFDLENBQUE7SUFBTSxJQUFDLENBQUE7SUFDM0IsSUFBQyxDQUFBLE1BQUQsR0FBVTtJQUNWLElBQUMsQ0FBQSxJQUFELEdBQVE7SUFDUixJQUFDLENBQUEsVUFBRCxHQUFjO0lBQ2QsSUFBQyxDQUFBLEdBQUQsR0FBTztJQUNQLElBQUMsQ0FBQSxLQUFELEdBQVM7SUFDVCxJQUFDLENBQUEsR0FBRCxHQUFPLEdBTFQ7SUFNRSxJQUFDLENBQUEsR0FBRCxHQUFPLEdBTlQ7SUFPRSxJQUFDLENBQUEsS0FBRCxHQUFTO0lBQ1QsSUFBQyxDQUFBLENBQUQsR0FBSztJQUNMLElBQUMsQ0FBQSxFQUFELEdBQU07RUFWTzs7RUFZZCxPQUFVLENBQUEsQ0FBQTtBQUNYLFFBQUEsQ0FBQSxFQUFBLENBQUEsRUFBQSxDQUFBLEVBQUEsR0FBQSxFQUFBO0lBQUUsQ0FBQSxHQUFJO0FBQ0o7SUFBQSxLQUFBLHFDQUFBOztNQUNDLElBQUcsQ0FBQSxLQUFLLEdBQVI7UUFBaUIsQ0FBQSxHQUFqQjs7TUFDQSxJQUFHLENBQUEsS0FBSyxHQUFSO1FBQWlCLENBQUEsR0FBakI7O0lBRkQ7V0FHQTtFQUxTOztFQU9WLFFBQVcsQ0FBQSxDQUFBO1dBQUcsQ0FBQSxDQUFBLENBQUcsTUFBQSxDQUFPLElBQUMsQ0FBQSxHQUFSLENBQVksQ0FBQyxRQUFiLENBQXNCLENBQXRCLEVBQXlCLEdBQXpCLENBQUgsRUFBQSxDQUFBLENBQW1DLElBQUMsQ0FBQSxJQUFwQyxDQUFBO0VBQUg7O0VBRVgsT0FBVSxDQUFDLElBQUQsQ0FBQTtBQUNYLFFBQUEsRUFBQSxFQUFBLEdBQUEsRUFBQSxDQUFBLEVBQUEsR0FBQSxFQUFBLEdBQUEsRUFBQSxDQUFBLEVBQUEsR0FBQSxFQUFBO0lBQUUsSUFBQyxDQUFBLENBQUQsR0FBSztJQUNMLElBQUMsQ0FBQSxFQUFELEdBQU07SUFDTixJQUFDLENBQUEsSUFBRCxHQUFRLENBQUMsSUFBQyxDQUFBLEdBQUYsRUFBTyxHQUFQO0FBQ1I7SUFBQSxLQUFBLHFDQUFBOztNQUNDLEVBQUEsR0FBSyxJQUFJLENBQUMsQ0FBRCxDQUFHLENBQUMsQ0FBRDtNQUNaLEtBQUEsR0FBUSxLQUFLLENBQUMsT0FBTixDQUFjLEVBQWQ7TUFDUixHQUFBLEdBQU0sSUFBSSxDQUFDLENBQUQsQ0FBRyxDQUFDLENBQUQ7TUFDYixJQUFHLEtBQUEsS0FBUyxDQUFDLENBQWI7UUFDQyxHQUFBLEdBQU0sTUFBTSxDQUFDLE9BQU8sQ0FBQyxHQUFELENBQUssQ0FBQztRQUMxQixJQUFDLENBQUEsQ0FBRCxJQUFNLEtBQUEsR0FBTTtRQUNaLElBQUcsR0FBQSxLQUFPLENBQVY7VUFDQyxJQUFDLENBQUEsRUFBRCxJQUFPLEtBQUEsR0FBTTtVQUNiLElBQUMsQ0FBQSxJQUFJLENBQUMsSUFBTixDQUFXLElBQUksQ0FBQyxLQUFMLENBQVcsR0FBWCxDQUFYLEVBRkQ7U0FIRDtPQUFBLE1BQUE7UUFPQyxJQUFDLENBQUEsSUFBSSxDQUFDLElBQU4sQ0FBVyxNQUFYLEVBUEQ7O0lBSkQ7SUFhQSxJQUFDLENBQUEsSUFBSSxDQUFDLElBQU4sQ0FBVyxJQUFDLENBQUEsRUFBWjtXQUNBLElBQUMsQ0FBQSxJQUFJLENBQUMsSUFBTixDQUFXLEdBQVg7RUFsQlM7O0VBb0JWLGVBQWtCLENBQUMsS0FBRCxFQUFPLENBQVAsQ0FBQTtBQUNuQixRQUFBLEtBQUEsRUFBQSxFQUFBLEVBQUEsR0FBQSxFQUFBLENBQUEsRUFBQSxHQUFBLEVBQUEsSUFBQSxFQUFBLEdBQUEsRUFBQSxJQUFBLEVBQUEsQ0FBQSxFQUFBLEdBQUEsRUFBQTtJQUFFLElBQUEsR0FBTyxLQUFLLENBQUMsQ0FBRCxFQUFkOztJQUVFLElBQUMsQ0FBQSxDQUFELEdBQUs7SUFDTCxJQUFDLENBQUEsRUFBRCxHQUFNO0lBQ04sSUFBQyxDQUFBLElBQUQsR0FBUTtBQUNSO0lBQUEsS0FBQSxxQ0FBQTs7TUFDQyxFQUFBLEdBQUssSUFBSSxDQUFDLENBQUQsQ0FBRyxDQUFDLENBQUQ7TUFDWixLQUFBLEdBQVEsS0FBSyxDQUFDLE9BQU4sQ0FBYyxFQUFkO01BQ1IsR0FBQSxHQUFNLElBQUksQ0FBQyxDQUFELENBQUcsQ0FBQyxDQUFEO01BQ2IsSUFBRyxLQUFBLEtBQVMsQ0FBQyxDQUFiO1FBQ0MsR0FBQSxHQUFNLE1BQU0sQ0FBQyxPQUFPLENBQUMsR0FBRCxDQUFLLENBQUM7UUFDMUIsSUFBQyxDQUFBLENBQUQsSUFBTSxLQUFBLEdBQU07UUFDWixJQUFHLEdBQUEsS0FBTyxDQUFWO1VBQ0MsSUFBQyxDQUFBLEVBQUQsSUFBTyxLQUFBLEdBQU07VUFDYixJQUFDLENBQUEsSUFBSSxDQUFDLElBQU4sQ0FBVyxJQUFJLENBQUMsS0FBTCxDQUFXLEdBQVgsQ0FBWCxFQUZEO1NBSEQ7O0lBSkQsQ0FMRjs7SUFpQkUsSUFBRyxJQUFDLENBQUEsSUFBSSxDQUFDLE1BQU4sS0FBZ0IsQ0FBbkI7YUFDQyxJQUFDLENBQUEsRUFBRCxHQUFNLEVBRFA7S0FBQSxNQUFBO01BR0MsS0FBQSxHQUFRLElBQUMsQ0FBQTtNQUNULElBQUEsR0FBTyxXQUFBLENBQVksS0FBWixFQUFtQixJQUFDLENBQUEsSUFBcEI7YUFDUCxJQUFDLENBQUEsRUFBRCxHQUFNLEtBTFA7O0VBbEJpQjs7QUEzQ1oiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge2VjaG8sZ2xvYmFsLHJhbmdlLHNldHRpbmdzfSBmcm9tICcuL2dsb2JhbC5qcydcclxuaW1wb3J0IHtwZXJmb3JtYW5jZX0gZnJvbSAnLi9yYXRpbmcuanMnXHJcblxyXG5leHBvcnQgY2xhc3MgUGxheWVyXHJcblxyXG5cdGNvbnN0cnVjdG9yIDogKEBpZCwgQG5hbWUsIEBlbG8pIC0+XHJcblx0XHRAZmlkZWlkID0gXCIxNzEyMzQ1XCJcclxuXHRcdEBib3JuID0gXCIwMDAwXCJcclxuXHRcdEBmZWRlcmF0aW9uID0gXCIgICBcIlxyXG5cdFx0QHNleCA9IFwiIFwiXHJcblx0XHRAdGl0bGUgPSBcIiAgIFwiXHJcblx0XHRAb3BwID0gW10gIyBhbnbDpG5kcyBlbmRhc3QgYXYgRmxvYXRpbmdcclxuXHRcdEBjb2wgPSBcIlwiICMgYW52w6RuZHMgZW5kYXN0IGF2IEZsb2F0aW5nXHJcblx0XHRAc3VtbWEgPSAwXHJcblx0XHRAUCA9IDBcclxuXHRcdEBQUiA9IDBcclxuXHJcblx0YmFsYW5jZSA6IC0+XHJcblx0XHRiID0gMFxyXG5cdFx0Zm9yIGMgaW4gQGNvbFxyXG5cdFx0XHRpZiBjID09ICd3JyB0aGVuIGIrK1xyXG5cdFx0XHRpZiBjID09ICdiJyB0aGVuIGItLVxyXG5cdFx0YlxyXG5cclxuXHR0b1N0cmluZyA6IC0+IFwiI3tTdHJpbmcoQGVsbykucGFkU3RhcnQgNCwgJzAnfSAje0BuYW1lfVwiXHJcblxyXG5cdGdldEVsb3MgOiAobG9uZykgLT5cclxuXHRcdEBQID0gMFxyXG5cdFx0QFBSID0gMFxyXG5cdFx0QGVsb3MgPSBbQGVsbywgJzonXVxyXG5cdFx0Zm9yIHIgaW4gcmFuZ2Ugc2V0dGluZ3MuR0FNRVMgKiBzZXR0aW5ncy5ST1VORFNcclxuXHRcdFx0Y2ggPSBsb25nW3JdWzNdXHJcblx0XHRcdHZhbHVlID0gJzAxMicuaW5kZXhPZiBjaFxyXG5cdFx0XHRvcHAgPSBsb25nW3JdWzFdXHJcblx0XHRcdGlmIHZhbHVlICE9IC0xXHJcblx0XHRcdFx0ZWxvID0gZ2xvYmFsLnBsYXllcnNbb3BwXS5lbG9cclxuXHRcdFx0XHRAUCArPSB2YWx1ZS8yXHJcblx0XHRcdFx0aWYgZWxvICE9IDBcclxuXHRcdFx0XHRcdEBQUiArPSB2YWx1ZS8yXHJcblx0XHRcdFx0XHRAZWxvcy5wdXNoIE1hdGgucm91bmQgZWxvXHJcblx0XHRcdGVsc2VcclxuXHRcdFx0XHRAZWxvcy5wdXNoICcgICAgJ1xyXG5cdFx0XHRcclxuXHRcdEBlbG9zLnB1c2ggQFBSXHJcblx0XHRAZWxvcy5qb2luICcgJ1xyXG5cclxuXHR1cGRhdGVfUF9hbmRfUFIgOiAobG9uZ3MsaSkgLT5cclxuXHRcdGxvbmcgPSBsb25nc1tpXVxyXG5cdFx0I2VjaG8gJ2xvbmdzJyxsb25nc1xyXG5cdFx0QFAgPSAwXHJcblx0XHRAUFIgPSAwXHJcblx0XHRAZWxvcyA9IFtdXHJcblx0XHRmb3IgciBpbiByYW5nZSBzZXR0aW5ncy5HQU1FUyAqIHNldHRpbmdzLlJPVU5EU1xyXG5cdFx0XHRjaCA9IGxvbmdbcl1bM11cclxuXHRcdFx0dmFsdWUgPSAnMDEyJy5pbmRleE9mIGNoXHJcblx0XHRcdG9wcCA9IGxvbmdbcl1bMV1cclxuXHRcdFx0aWYgdmFsdWUgIT0gLTFcclxuXHRcdFx0XHRlbG8gPSBnbG9iYWwucGxheWVyc1tvcHBdLmVsb1xyXG5cdFx0XHRcdEBQICs9IHZhbHVlLzJcclxuXHRcdFx0XHRpZiBlbG8gIT0gMFxyXG5cdFx0XHRcdFx0QFBSICs9IHZhbHVlLzJcclxuXHRcdFx0XHRcdEBlbG9zLnB1c2ggTWF0aC5yb3VuZCBlbG9cclxuXHJcblx0XHQjIGthbGt5bGVyYSBwZXJmb3JtYW5jZSByYXRpbmcgbWhhIHZpbnN0YW5kZWwgb2NoIGVsby10YWxcclxuXHRcdGlmIEBlbG9zLmxlbmd0aCA9PSAwIFxyXG5cdFx0XHRAUFIgPSAwXHJcblx0XHRlbHNlXHJcblx0XHRcdGFuZGVsID0gQFBSXHJcblx0XHRcdHBlcmYgPSBwZXJmb3JtYW5jZSBhbmRlbCwgQGVsb3NcclxuXHRcdFx0QFBSID0gcGVyZlxyXG4iXX0=
//# sourceURL=c:\github\2025\035-FairPair\player.coffee