// Generated by CoffeeScript 2.7.0
var NAME_LEN, NBSP, div, toSortKey;

import {
  tag
} from './fasthtml.js';

div = tag("div");

NAME_LEN = 21;

NBSP = "\u00A0";

toSortKey = function(name) { // name
  var out;
  //name = name.textContent
  out = name != null ? name : "";
  if (out.length > NAME_LEN) {
    out = out.slice(0, NAME_LEN);
  }
  return out.trim().toLocaleLowerCase('sv-SE');
};

export var Select = class Select {
  constructor({items = [], onCountChange = null} = {}) {
    var j, len, name;
    this.onKeydown = this.onKeydown.bind(this);
    this.onCountChange = onCountChange;
    this.selectedIndex = -1;
    this.element = div({
      tabindex: "0",
      style: "font-family:monospace; font-size:14px; width:360px; height:360px; overflow-y:auto; border:1px solid #999; " //white-space:pre;"
    });
    this.element.addEventListener('keydown', this.onKeydown);
    this.element.addEventListener('focus', () => {
      return this.paintSelection();
    });
    this.element.addEventListener('blur', () => {
      return this.paintSelection();
    });
    for (j = 0, len = items.length; j < len; j++) {
      name = items[j];
      this.add(name);
    }
    this.setSelectedIndex(0);
    this.notifyCount();
  }

  notifyCount() {
    return typeof this.onCountChange === "function" ? this.onCountChange(this.element.children.length) : void 0;
  }

  setSelectedIndex(i) {
    var count, next, row;
    count = this.element.children.length;
    if (count === 0) {
      this.selectedIndex = -1;
      return;
    }
    if (!Number.isFinite(i)) {
      i = 0;
    }
    next = Math.max(0, Math.min(i, count - 1));
    this.selectedIndex = next;
    this.paintSelection();
    row = this.element.children[this.selectedIndex];
    return row.scrollIntoView({
      block: "nearest"
    });
  }

  paintSelection() {
    var j, len, ref, row;
    ref = this.element.children;
    for (j = 0, len = ref.length; j < len; j++) {
      row = ref[j];
      row.style.background = "";
    }
    if (this.selectedIndex < 0) {
      return;
    }
    row = this.element.children[this.selectedIndex];
    if (row == null) {
      return;
    }
    if (document.activeElement === this.element) {
      return row.style.background = "#cfe8ff";
    } else {
      return row.style.background = "#e8e8e8";
    }
  }

  sort(preferredRow = null) {
    var i, j, len, row, rows;
    rows = Array.prototype.slice.call(this.element.children);
    rows.sort(function(a, b) {
      return a.dataset.sortKey.localeCompare(b.dataset.sortKey, 'sv', {
        sensitivity: 'base'
      });
    });
    for (j = 0, len = rows.length; j < len; j++) {
      row = rows[j];
      this.element.appendChild(row);
    }
    if (rows.length === 0) {
      this.selectedIndex = -1;
      this.notifyCount();
      return;
    }
    if (preferredRow != null) {
      i = rows.indexOf(preferredRow);
      if (i < 0) {
        i = 0;
      }
      this.setSelectedIndex(i);
    } else {
      this.setSelectedIndex(Math.max(0, Math.min(this.selectedIndex, rows.length - 1)));
    }
    return this.notifyCount();
  }

  selectByInitial(char, backwards = false) {
    var i, j, k, l, len, len1, len2, matches, needle, ref, revMatches, row, rows, target;
    rows = Array.prototype.slice.call(this.element.children);
    if (rows.length === 0) {
      return;
    }
    needle = char.toLocaleLowerCase('sv-SE');
    matches = [];
    for (i = j = 0, len = rows.length; j < len; i = ++j) {
      row = rows[i];
      if ((ref = row.dataset.sortKey) != null ? ref.startsWith(needle) : void 0) {
        matches.push(i);
      }
    }
    if (matches.length === 0) {
      return;
    }
    if (backwards) {
      revMatches = matches.slice().reverse();
      target = revMatches[0];
      for (k = 0, len1 = revMatches.length; k < len1; k++) {
        i = revMatches[k];
        if (!(i < this.selectedIndex)) {
          continue;
        }
        target = i;
        break;
      }
    } else {
      target = matches[0];
      for (l = 0, len2 = matches.length; l < len2; l++) {
        i = matches[l];
        if (!(i > this.selectedIndex)) {
          continue;
        }
        target = i;
        break;
      }
    }
    return this.setSelectedIndex(target);
  }

  add(name, pick = false) {
    var row;
    row = div({
      class: "people",
      //style: "line-height:18px; padding:0 4px; cursor:default;"
      dataset: {
        sortKey: toSortKey(name)
      }
    }, name);
    row.addEventListener("click", () => {
      var i;
      i = Array.prototype.indexOf.call(this.element.children, row);
      if (i >= 0) {
        this.setSelectedIndex(i);
        return this.element.focus();
      }
    });
    this.element.appendChild(row);
    return this.sort(pick ? row : null);
  }

  removeSelected() {
    var count, i;
    count = this.element.children.length;
    if (count === 0) {
      return;
    }
    i = this.selectedIndex >= 0 ? this.selectedIndex : count - 1;
    this.element.removeChild(this.element.children[i]);
    if (this.element.children.length === 0) {
      this.selectedIndex = -1;
      this.notifyCount();
      return;
    }
    this.setSelectedIndex(Math.min(i, this.element.children.length - 1));
    return this.notifyCount();
  }

  clear() {
    this.element.innerHTML = '';
    this.selectedIndex = -1;
    return this.notifyCount();
  }

  focus() {
    return this.element.focus();
  }

  onKeydown(e) {
    if (e.key === 'ArrowUp') {
      e.preventDefault();
      return this.setSelectedIndex(this.selectedIndex - 1);
    } else if (e.key === 'ArrowDown') {
      e.preventDefault();
      return this.setSelectedIndex(this.selectedIndex + 1);
    } else if (e.key.length === 1 && !e.ctrlKey && !e.metaKey && !e.altKey) {
      e.preventDefault();
      return this.selectByInitial(e.key, e.shiftKey);
    }
  }

};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2VsZWN0LmpzIiwic291cmNlUm9vdCI6IlxcIiwic291cmNlcyI6WyJzZWxlY3QuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxJQUFBLFFBQUEsRUFBQSxJQUFBLEVBQUEsR0FBQSxFQUFBOztBQUFBLE9BQUE7RUFBUSxHQUFSO0NBQUEsTUFBQTs7QUFFQSxHQUFBLEdBQU0sR0FBQSxDQUFJLEtBQUo7O0FBRU4sUUFBQSxHQUFXOztBQUNYLElBQUEsR0FBTzs7QUFFUCxTQUFBLEdBQVksUUFBQSxDQUFDLElBQUQsQ0FBQSxFQUFBO0FBRVosTUFBQSxHQUFBOztFQUFDLEdBQUEsa0JBQU0sT0FBTztFQUNiLElBQUcsR0FBRyxDQUFDLE1BQUosR0FBYSxRQUFoQjtJQUE4QixHQUFBLEdBQU0sR0FBRyxDQUFDLEtBQUosQ0FBVSxDQUFWLEVBQWEsUUFBYixFQUFwQzs7U0FDQSxHQUFHLENBQUMsSUFBSixDQUFBLENBQVUsQ0FBQyxpQkFBWCxDQUE2QixPQUE3QjtBQUpXOztBQU1aLE9BQUEsSUFBYSxTQUFOLE1BQUEsT0FBQTtFQUNOLFdBQWEsQ0FBQyxDQUFDLEtBQUEsR0FBUSxFQUFULEVBQWEsYUFBQSxHQUFnQixJQUE3QixJQUFxQyxDQUFBLENBQXRDLENBQUE7QUFDZCxRQUFBLENBQUEsRUFBQSxHQUFBLEVBQUE7UUE4SEMsQ0FBQSxnQkFBQSxDQUFBO0lBOUhDLElBQUMsQ0FBQSxhQUFELEdBQWlCO0lBQ2pCLElBQUMsQ0FBQSxhQUFELEdBQWlCLENBQUM7SUFDbEIsSUFBQyxDQUFBLE9BQUQsR0FBVyxHQUFBLENBQ1Y7TUFBQSxRQUFBLEVBQVUsR0FBVjtNQUNBLEtBQUEsRUFBTyw0R0FEUDtJQUFBLENBRFU7SUFJWCxJQUFDLENBQUEsT0FBTyxDQUFDLGdCQUFULENBQTBCLFNBQTFCLEVBQXFDLElBQUMsQ0FBQSxTQUF0QztJQUNBLElBQUMsQ0FBQSxPQUFPLENBQUMsZ0JBQVQsQ0FBMEIsT0FBMUIsRUFBbUMsQ0FBQSxDQUFBLEdB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QyxHQUFHLENBQUMsTUFBTixLQUFnQixDQUFoQixJQUFzQixDQUFJLENBQUMsQ0FBQyxPQUE1QixJQUF3QyxDQUFJLENBQUMsQ0FBQyxPQUE5QyxJQUEwRCxDQUFJLENBQUMsQ0FBQyxNQUFuRTtNQUNKLENBQUMsQ0FBQyxjQUFGLENBQUE7YUFDQSxJQUFDLENBQUEsZUFBRCxDQUFpQixDQUFDLENBQUMsR0FBbkIsRUFBd0IsQ0FBQyxDQUFDLFFBQTFCLEVBRkk7O0VBUEs7O0FBaElMIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHt0YWd9IGZyb20gJy4vZmFzdGh0bWwuanMnXHJcblxyXG5kaXYgPSB0YWcgXCJkaXZcIlxyXG5cclxuTkFNRV9MRU4gPSAyMVxyXG5OQlNQID0gXCJcXHUwMEEwXCJcclxuXHJcbnRvU29ydEtleSA9IChuYW1lKSAtPiAjIG5hbWVcclxuXHQjbmFtZSA9IG5hbWUudGV4dENvbnRlbnRcclxuXHRvdXQgPSBuYW1lID8gXCJcIlxyXG5cdGlmIG91dC5sZW5ndGggPiBOQU1FX0xFTiB0aGVuIG91dCA9IG91dC5zbGljZSAwLCBOQU1FX0xFTlxyXG5cdG91dC50cmltKCkudG9Mb2NhbGVMb3dlckNhc2UgJ3N2LVNFJ1xyXG5cclxuZXhwb3J0IGNsYXNzIFNlbGVjdFxyXG5cdGNvbnN0cnVjdG9yOiAoe2l0ZW1zID0gW10sIG9uQ291bnRDaGFuZ2UgPSBudWxsfSA9IHt9KSAtPlxyXG5cdFx0QG9uQ291bnRDaGFuZ2UgPSBvbkNvdW50Q2hhbmdlXHJcblx0XHRAc2VsZWN0ZWRJbmRleCA9IC0xXHJcblx0XHRAZWxlbWVudCA9IGRpdlxyXG5cdFx0XHR0YWJpbmRleDogXCIwXCJcclxuXHRcdFx0c3R5bGU6IFwiZm9udC1mYW1pbHk6bW9ub3NwYWNlOyBmb250LXNpemU6MTRweDsgd2lkdGg6MzYwcHg7IGhlaWdodDozNjBweDsgb3ZlcmZsb3cteTphdXRvOyBib3JkZXI6MXB4IHNvbGlkICM5OTk7IFwiICN3aGl0ZS1zcGFjZTpwcmU7XCJcclxuXHJcblx0XHRAZWxlbWVudC5hZGRFdmVudExpc3RlbmVyICdrZXlkb3duJywgQG9uS2V5ZG93blxyXG5cdFx0QGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lciAnZm9jdXMnLCA9PiBAcGFpbnRTZWxlY3Rpb24oKVxyXG5cdFx0QGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lciAnYmx1cicsID0+IEBwYWludFNlbGVjdGlvbigpXHJcblxyXG5cdFx0Zm9yIG5hbWUgaW4gaXRlbXNcclxuXHRcdFx0QGFkZCBuYW1lXHJcblx0XHRAc2V0U2VsZWN0ZWRJbmRleCAwXHJcblx0XHRAbm90aWZ5Q291bnQoKVxyXG5cclxuXHRub3RpZnlDb3VudDogLT5cclxuXHRcdEBvbkNvdW50Q2hhbmdlPyBAZWxlbWVudC5jaGlsZHJlbi5sZW5ndGhcclxuXHJcblx0c2V0U2VsZWN0ZWRJbmRleDogKGkpIC0+XHJcblx0XHRjb3VudCA9IEBlbGVtZW50LmNoaWxkcmVuLmxlbmd0aFxyXG5cdFx0aWYgY291bnQgPT0gMFxyXG5cdFx0XHRAc2VsZWN0ZWRJbmRleCA9IC0xXHJcblx0XHRcdHJldHVyblxyXG5cclxuXHRcdGlmIG5vdCBOdW1iZXIuaXNGaW5pdGUoaSkgdGhlbiBpID0gMFxyXG5cdFx0bmV4dCA9IE1hdGgubWF4IDAsIE1hdGgubWluIGksIGNvdW50IC0gMVxyXG5cdFx0QHNlbGVjdGVkSW5kZXggPSBuZXh0XHJcblx0XHRAcGFpbnRTZWxlY3Rpb24oKVxyXG5cdFx0cm93ID0gQGVsZW1lbnQuY2hpbGRyZW5bQHNlbGVjdGVkSW5kZXhdXHJcblx0XHRyb3cuc2Nyb2xsSW50b1ZpZXcgYmxvY2s6IFwibmVhcmVzdFwiXHJcblxyXG5cdHBhaW50U2VsZWN0aW9uOiAtPlxyXG5cdFx0Zm9yIHJvdyBpbiBAZWxlbWVudC5jaGlsZHJlblxyXG5cdFx0XHRyb3cuc3R5bGUuYmFja2dyb3VuZCA9IFwiXCJcclxuXHRcdHJldHVybiBpZiBAc2VsZWN0ZWRJbmRleCA8IDBcclxuXHRcdHJvdyA9IEBlbGVtZW50LmNoaWxkcmVuW0BzZWxlY3RlZEluZGV4XVxyXG5cdFx0cmV0dXJuIHVubGVzcyByb3c/XHJcblx0XHRpZiBkb2N1bWVudC5hY3RpdmVFbGVtZW50IGlzIEBlbGVtZW50XHJcblx0XHRcdHJvdy5zdHlsZS5iYWNrZ3JvdW5kID0gXCIjY2ZlOGZmXCJcclxuXHRcdGVsc2VcclxuXHRcdFx0cm93LnN0eWxlLmJhY2tncm91bmQgPSBcIiNlOGU4ZThcIlxyXG5cclxuXHRzb3J0OiAocHJlZmVycmVkUm93ID0gbnVsbCkgLT5cclxuXHRcdHJvd3MgPSBBcnJheTo6c2xpY2UuY2FsbCBAZWxlbWVudC5jaGlsZHJlblxyXG5cdFx0cm93cy5zb3J0IChhLCBiKSAtPiBhLmRhdGFzZXQuc29ydEtleS5sb2NhbGVDb21wYXJlIGIuZGF0YXNldC5zb3J0S2V5LCAnc3YnLCBzZW5zaXRpdml0eTonYmFzZSdcclxuXHRcdGZvciByb3cgaW4gcm93c1xyXG5cdFx0XHRAZWxlbWVudC5hcHBlbmRDaGlsZCByb3dcclxuXHJcblx0XHRpZiByb3dzLmxlbmd0aCA9PSAwXHJcblx0XHRcdEBzZWxlY3RlZEluZGV4ID0gLTFcclxuXHRcdFx0QG5vdGlmeUNvdW50KClcclxuXHRcdFx0cmV0dXJuXHJcblxyXG5cdFx0aWYgcHJlZmVycmVkUm93P1xyXG5cdFx0XHRpID0gcm93cy5pbmRleE9mIHByZWZlcnJlZFJvd1xyXG5cdFx0XHRpZiBpIDwgMCB0aGVuIGkgPSAwXHJcblx0XHRcdEBzZXRTZWxlY3RlZEluZGV4IGlcclxuXHRcdGVsc2VcclxuXHRcdFx0QHNldFNlbGVjdGVkSW5kZXggTWF0aC5tYXggMCwgTWF0aC5taW4gQHNlbGVjdGVkSW5kZXgsIHJvd3MubGVuZ3RoIC0gMVxyXG5cclxuXHRcdEBub3RpZnlDb3VudCgpXHJcblxyXG5cdHNlbGVjdEJ5SW5pdGlhbDogKGNoYXIsIGJhY2t3YXJkcyA9IGZhbHNlKSAtPlxyXG5cdFx0cm93cyA9IEFycmF5OjpzbGljZS5jYWxsIEBlbGVtZW50LmNoaWxkcmVuXHJcblx0XHRpZiByb3dzLmxlbmd0aCA9PSAwIHRoZW4gcmV0dXJuXHJcblxyXG5cdFx0bmVlZGxlID0gY2hhci50b0xvY2FsZUxvd2VyQ2FzZSAnc3YtU0UnXHJcblx0XHRtYXRjaGVzID0gW11cclxuXHRcdGZvciByb3csIGkgaW4gcm93cyB3aGVuIHJvdy5kYXRhc2V0LnNvcnRLZXk/LnN0YXJ0c1dpdGggbmVlZGxlXHJcblx0XHRcdG1hdGNoZXMucHVzaCBpXHJcblxyXG5cdFx0aWYgbWF0Y2hlcy5sZW5ndGggPT0gMCB0aGVuIHJldHVyblxyXG5cclxuXHRcdGlmIGJhY2t3YXJkc1xyXG5cdFx0XHRyZXZNYXRjaGVzID0gbWF0Y2hlcy5zbGljZSgpLnJldmVyc2UoKVxyXG5cdFx0XHR0YXJnZXQgPSByZXZNYXRjaGVzWzBdXHJcblx0XHRcdGZvciBpIGluIHJldk1hdGNoZXMgd2hlbiBpIDwgQHNlbGVjdGVkSW5kZXhcclxuXHRcdFx0XHR0YXJnZXQgPSBpXHJcblx0XHRcdFx0YnJlYWtcclxuXHRcdGVsc2VcclxuXHRcdFx0dGFyZ2V0ID0gbWF0Y2hlc1swXVxyXG5cdFx0XHRmb3IgaSBpbiBtYXRjaGVzIHdoZW4gaSA+IEBzZWxlY3RlZEluZGV4XHJcblx0XHRcdFx0dGFyZ2V0ID0gaVxyXG5cdFx0XHRcdGJyZWFrXHJcblxyXG5cdFx0QHNldFNlbGVjdGVkSW5kZXggdGFyZ2V0XHJcblxyXG5cdGFkZDogKG5hbWUsIHBpY2sgPSBmYWxzZSkgLT5cclxuXHRcdHJvdyA9IGRpdlxyXG5cdFx0XHRjbGFzczogXCJwZW9wbGVcIlxyXG5cdFx0XHQjc3R5bGU6IFwibGluZS1oZWlnaHQ6MThweDsgcGFkZGluZzowIDRweDsgY3Vyc29yOmRlZmF1bHQ7XCJcclxuXHRcdFx0ZGF0YXNldDogc29ydEtleTogdG9Tb3J0S2V5KG5hbWUpXHJcblx0XHRcdG5hbWVcclxuXHJcblx0XHRyb3cuYWRkRXZlbnRMaXN0ZW5lciBcImNsaWNrXCIsID0+XHJcblx0XHRcdGkgPSBBcnJheTo6aW5kZXhPZi5jYWxsIEBlbGVtZW50LmNoaWxkcmVuLCByb3dcclxuXHRcdFx0aWYgaSA+PSAwXHJcblx0XHRcdFx0QHNldFNlbGVjdGVkSW5kZXggaVxyXG5cdFx0XHRcdEBlbGVtZW50LmZvY3VzKClcclxuXHJcblx0XHRAZWxlbWVudC5hcHBlbmRDaGlsZCByb3dcclxuXHRcdEBzb3J0IGlmIHBpY2sgdGhlbiByb3cgZWxzZSBudWxsXHJcblxyXG5cdHJlbW92ZVNlbGVjdGVkOiAtPlxyXG5cdFx0Y291bnQgPSBAZWxlbWVudC5jaGlsZHJlbi5sZW5ndGhcclxuXHRcdGlmIGNvdW50ID09IDAgdGhlbiByZXR1cm5cclxuXHJcblx0XHRpID0gaWYgQHNlbGVjdGVkSW5kZXggPj0gMCB0aGVuIEBzZWxlY3RlZEluZGV4IGVsc2UgY291bnQgLSAxXHJcblx0XHRAZWxlbWVudC5yZW1vdmVDaGlsZCBAZWxlbWVudC5jaGlsZHJlbltpXVxyXG5cclxuXHRcdGlmIEBlbGVtZW50LmNoaWxkcmVuLmxlbmd0aCA9PSAwXHJcblx0XHRcdEBzZWxlY3RlZEluZGV4ID0gLTFcclxuXHRcdFx0QG5vdGlmeUNvdW50KClcclxuXHRcdFx0cmV0dXJuXHJcblxyXG5cdFx0QHNldFNlbGVjdGVkSW5kZXggTWF0aC5taW4gaSwgQGVsZW1lbnQuY2hpbGRyZW4ubGVuZ3RoIC0gMVxyXG5cdFx0QG5vdGlmeUNvdW50KClcclxuXHJcblx0Y2xlYXI6IC0+XHJcblx0XHRAZWxlbWVudC5pbm5lckhUTUwgPSAnJ1xyXG5cdFx0QHNlbGVjdGVkSW5kZXggPSAtMVxyXG5cdFx0QG5vdGlmeUNvdW50KClcclxuXHJcblx0Zm9jdXM6IC0+XHJcblx0XHRAZWxlbWVudC5mb2N1cygpXHJcblxyXG5cdG9uS2V5ZG93bjogKGUpID0+XHJcblx0XHRpZiBlLmtleSA9PSAnQXJyb3dVcCdcclxuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpXHJcblx0XHRcdEBzZXRTZWxlY3RlZEluZGV4IEBzZWxlY3RlZEluZGV4IC0gMVxyXG5cdFx0ZWxzZSBpZiBlLmtleSA9PSAnQXJyb3dEb3duJ1xyXG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KClcclxuXHRcdFx0QHNldFNlbGVjdGVkSW5kZXggQHNlbGVjdGVkSW5kZXggKyAxXHJcblx0XHRlbHNlIGlmIGUua2V5Lmxlbmd0aCA9PSAxIGFuZCBub3QgZS5jdHJsS2V5IGFuZCBub3QgZS5tZXRhS2V5IGFuZCBub3QgZS5hbHRLZXlcclxuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpXHJcblx0XHRcdEBzZWxlY3RCeUluaXRpYWwgZS5rZXksIGUuc2hpZnRLZXlcclxuIl19
//# sourceURL=c:\github\2025\035-FairPair\select.coffee