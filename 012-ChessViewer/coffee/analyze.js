// Generated by CoffeeScript 2.7.0
var add, addLink, best, byt, calcLoss, echo, evals, figurine, getParam, klass, makeTables, moves, params, parseMove, showBest, showLoss, state,
  indexOf = [].indexOf;

echo = console.log;

state = {
  letter: 0,
  loss: 0,
  best: 0 // visa bättre drag
};

params = null;

moves = [];

evals = [];

best = [];

byt = function(san, a, b) {
  var i, j, ref;
  for (i = j = 0, ref = a.length; (0 <= ref ? j < ref : j > ref); i = 0 <= ref ? ++j : --j) {
    san = san.replace(a[i], b[i]);
  }
  return san;
};

figurine = function(san) {
  if (state.letter === 1) {
    return byt(san, 'QRBN', 'DTLS');
  } else {
    return byt(san, 'DTLS', 'QRBN');
  }
};

getParam = function(name) {
  var param;
  params = new URLSearchParams(window.location.search);
  param = params.get(name);
  if (indexOf.call("move eval best".split(' '), name) >= 0) {
    return (param != null ? param.split("_") : void 0) || [];
  }
  return param;
};

klass = function(value) {
  value = Math.abs(value);
  if (value < 20) {
    return "";
  }
  if (value < 50) {
    return "•";
  }
  if (value < 100) {
    return "••";
  }
  if (value < 300) {
    return "•••";
  }
  return "••••";
};

parseMove = function(moveStr, chess) {
  var allMoves, j, len, m;
  allMoves = chess.moves({
    verbose: true
  });
  for (j = 0, len = allMoves.length; j < len; j++) {
    m = allMoves[j];
    if (m.san === moveStr) {
      return {
        from: m.from,
        to: m.to
      };
    }
  }
  return null;
};

add = function(tr, text, alignment = 'right') {
  var td;
  td = document.createElement("td");
  td.style = `text-align: ${alignment};`;
  td.textContent = text;
  return tr.appendChild(td);
};

addLink = function(tr, href, text, alignment = 'right') {
  var td;
  td = document.createElement("td");
  td.style = `text-align: ${alignment};`;
  td.innerHTML = `<a href='${href}'>${text}</a>`;
  return tr.appendChild(td);
};

calcLoss = function(i) {
  return evals[i];
};

showLoss = function(i) {
  if (state.loss === 0) {
    return klass(evals[i]);
  }
  if (state.loss === 1) {
    return evals[i];
  }
};

showBest = function(i) {
  if (state.best === 1) {
    return best[i];
  }
  if (best[i] !== moves[i] && calcLoss(i) >= 20) {
    return best[i];
  }
  return '';
};

makeTables = function() {
  var i, j, k, key, keys, l, len, len1, ref, ref1, results, tbody, tbodypgn, tr, value;
  tbodypgn = document.querySelector("#pgnHeaders tbody");
  tbody = document.querySelector("#chessTable tbody");
  tbodypgn.innerHTML = "";
  tbody.innerHTML = "";
  keys = [];
  ref = [...params.entries()];
  for (j = 0, len = ref.length; j < len; j++) {
    [key, value] = ref[j];
    keys.push(key);
  }
  for (k = 0, len1 = keys.length; k < len1; k++) {
    key = keys[k];
    if (indexOf.call('move eval best'.split(' '), key) >= 0) {
      continue;
    }
    tr = document.createElement("tr");
    add(tr, key, 'right');
    if (key === 'Link') {
      addLink(tr, getParam(key), "Link", 'left');
    } else {
      add(tr, getParam(key).replaceAll("_", " "), 'left');
    }
    tbodypgn.appendChild(tr);
  }
  moves = getParam("move").map(figurine);
  evals = getParam("eval").map(parseFloat);
  best = getParam("best").map(figurine);
  echo(moves);
  echo(evals);
  echo(best);
// Fyll i tabellen
  results = [];
  for (i = l = 0, ref1 = moves.length; l < ref1; i = l += 2) {
    tr = document.createElement("tr");
    //if i==0 then continue
    add(tr, showBest(i));
    add(tr, showLoss(i));
    add(tr, moves[i]);
    add(tr, (Math.floor(i / 2)) + 1, 'center');
    add(tr, moves[i + 1], 'left');
    add(tr, showLoss(i + 1), 'left');
    add(tr, showBest(i + 1), 'left');
    results.push(tbody.appendChild(tr));
  }
  return results;
};

window.onload = function() {
  params = new URLSearchParams(window.location.search);
  return makeTables();
};

document.addEventListener('keydown', function(event) {
  echo("Tangent nedtryckt:", event.key);
  if (event.key === 'l') {
    state.letter = 1 - state.letter;
    makeTables();
  }
  if (event.key === 'd') {
    state.loss = 1 - state.loss;
    state.best = 1 - state.best;
    return makeTables();
  }
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYW5hbHl6ZS5qcyIsInNvdXJjZVJvb3QiOiIuLlxcIiwic291cmNlcyI6WyJjb2ZmZWVcXGFuYWx5emUuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxJQUFBLEdBQUEsRUFBQSxPQUFBLEVBQUEsSUFBQSxFQUFBLEdBQUEsRUFBQSxRQUFBLEVBQUEsSUFBQSxFQUFBLEtBQUEsRUFBQSxRQUFBLEVBQUEsUUFBQSxFQUFBLEtBQUEsRUFBQSxVQUFBLEVBQUEsS0FBQSxFQUFBLE1BQUEsRUFBQSxTQUFBLEVBQUEsUUFBQSxFQUFBLFFBQUEsRUFBQSxLQUFBO0VBQUE7O0FBQUEsSUFBQSxHQUFPLE9BQU8sQ0FBQzs7QUFFZixLQUFBLEdBQ0U7RUFBQSxNQUFBLEVBQVEsQ0FBUjtFQUNBLElBQUEsRUFBTSxDQUROO0VBRUEsSUFBQSxFQUFNLENBRk47QUFBQTs7QUFJRixNQUFBLEdBQVM7O0FBRVQsS0FBQSxHQUFROztBQUNSLEtBQUEsR0FBUTs7QUFDUixJQUFBLEdBQU87O0FBRVAsR0FBQSxHQUFNLFFBQUEsQ0FBQyxHQUFELEVBQU0sQ0FBTixFQUFTLENBQVQsQ0FBQTtBQUNOLE1BQUEsQ0FBQSxFQUFBLENBQUEsRUFBQTtFQUFFLEtBQVMsbUZBQVQ7SUFDRSxHQUFBLEdBQU0sR0FBRyxDQUFDLE9BQUosQ0FBWSxDQUFDLENBQUMsQ0FBRCxDQUFiLEVBQWtCLENBQUMsQ0FBQyxDQUFELENBQW5CO0VBRFI7U0FFQTtBQUhJOztBQUtOLFFBQUEsR0FBVyxRQUFBLENBQUMsR0FBRCxDQUFBO0VBQVMsSUFBRyxLQUFLLENBQUMsTUFBTixLQUFnQixDQUFuQjtXQUEwQixHQUFBLENBQUksR0FBSixFQUFTLE1BQVQsRUFBZ0IsTUFBaEIsRUFBMUI7R0FBQSxNQUFBO1dBQXNELEdBQUEsQ0FBSSxHQUFKLEVBQVMsTUFBVCxFQUFnQixNQUFoQixFQUF0RDs7QUFBVDs7QUFFWCxRQUFBLEdBQVcsUUFBQSxDQUFDLElBQUQsQ0FBQTtBQUNYLE1BQUE7RUFB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RUFDQSxJQUFHLEtBQUssQ0FBQyxHQUFOLEtBQWEsR0FBaEI7SUFDRSxLQUFLLENBQUMsTUFBTixHQUFlLENBQUEsR0FBSSxLQUFLLENBQUM7SUFDekIsVUFBQSxDQUFBLEVBRkY7O0VBSUEsSUFBRyxLQUFLLENBQUMsR0FBTixLQUFhLEdBQWhCO0lBQ0UsS0FBSyxDQUFDLElBQU4sR0FBYSxDQUFBLEdBQUksS0FBSyxDQUFDO0lBQ3ZCLEtBQUssQ0FBQyxJQUFOLEdBQWEsQ0FBQSxHQUFJLEtBQUssQ0FBQztXQUN2QixVQUFBLENBQUEsRUFIRjs7QUFObUMsQ0FBckMiLCJzb3VyY2VzQ29udGVudCI6WyJlY2hvID0gY29uc29sZS5sb2dcclxuXHJcbnN0YXRlID1cclxuICBsZXR0ZXI6IDBcclxuICBsb3NzOiAwXHJcbiAgYmVzdDogMCAjIHZpc2EgYsOkdHRyZSBkcmFnXHJcblxyXG5wYXJhbXMgPSBudWxsXHJcblxyXG5tb3ZlcyA9IFtdXHJcbmV2YWxzID0gW11cclxuYmVzdCA9IFtdXHJcblxyXG5ieXQgPSAoc2FuLCBhLCBiKSAtPlxyXG4gIGZvciBpIGluIFswLi4uYS5sZW5ndGhdXHJcbiAgICBzYW4gPSBzYW4ucmVwbGFjZSBhW2ldLCBiW2ldXHJcbiAgc2FuXHJcblxyXG5maWd1cmluZSA9IChzYW4pIC0+IGlmIHN0YXRlLmxldHRlciA9PSAxIHRoZW4gYnl0IHNhbiwgJ1FSQk4nLCdEVExTJyBlbHNlIGJ5dCBzYW4sICdEVExTJywnUVJCTidcclxuXHJcbmdldFBhcmFtID0gKG5hbWUpIC0+XHJcbiAgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyB3aW5kb3cubG9jYXRpb24uc2VhcmNoXHJcbiAgcGFyYW0gPSBwYXJhbXMuZ2V0KG5hbWUpXHJcbiAgaWYgbmFtZSBpbiBcIm1vdmUgZXZhbCBiZXN0XCIuc3BsaXQgJyAnIHRoZW4gcmV0dXJuIHBhcmFtPy5zcGxpdChcIl9cIikgb3IgW11cclxuICBwYXJhbVxyXG4gXHJcbmtsYXNzID0gKHZhbHVlKSAtPiBcclxuICB2YWx1ZSA9IE1hdGguYWJzIHZhbHVlXHJcbiAgaWYgdmFsdWUgPCAyMCAgdGhlbiByZXR1cm4gXCJcIlxyXG4gIGlmIHZhbHVlIDwgNTAgIHRoZW4gcmV0dXJuIFwi4oCiXCJcclxuICBpZiB2YWx1ZSA8IDEwMCAgdGhlbiByZXR1cm4gXCLigKLigKJcIlxyXG4gIGlmIHZhbHVlIDwgMzAwICB0aGVuIHJldHVybiBcIuKAouKAouKAolwiXHJcbiAgXCLigKLigKLigKLigKJcIlxyXG5cclxucGFyc2VNb3ZlID0gKG1vdmVTdHIsIGNoZXNzKSAtPlxyXG4gIGFsbE1vdmVzID0gY2hlc3MubW92ZXMoeyB2ZXJib3NlOiB0cnVlIH0pXHJcbiAgZm9yIG0gaW4gYWxsTW92ZXMgd2hlbiBtLnNhbiBpcyBtb3ZlU3RyXHJcbiAgICByZXR1cm4geyBmcm9tOiBtLmZyb20sIHRvOiBtLnRvIH1cclxuICBudWxsXHJcblxyXG5hZGQgPSAodHIsdGV4dCxhbGlnbm1lbnQ9J3JpZ2h0JykgLT5cclxuICB0ZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQgXCJ0ZFwiXHJcbiAgdGQuc3R5bGUgPSBcInRleHQtYWxpZ246ICN7YWxpZ25tZW50fTtcIlxyXG4gIHRkLnRleHRDb250ZW50ID0gdGV4dFxyXG4gIHRyLmFwcGVuZENoaWxkIHRkXHJcblxyXG5hZGRMaW5rID0gKHRyLGhyZWYsdGV4dCxhbGlnbm1lbnQ9J3JpZ2h0JykgLT5cclxuICB0ZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQgXCJ0ZFwiXHJcbiAgdGQuc3R5bGUgPSBcInRleHQtYWxpZ246ICN7YWxpZ25tZW50fTtcIlxyXG4gIHRkLmlubmVySFRNTCA9IFwiPGEgaHJlZj0nI3tocmVmfSc+I3t0ZXh0fTwvYT5cIlxyXG4gIHRyLmFwcGVuZENoaWxkIHRkXHJcblxyXG5jYWxjTG9zcyA9IChpKSAtPiBldmFsc1tpXVxyXG5cclxuc2hvd0xvc3MgPSAoaSkgLT5cclxuICBpZiBzdGF0ZS5sb3NzID09IDAgdGhlbiByZXR1cm4ga2xhc3MgZXZhbHNbaV1cclxuICBpZiBzdGF0ZS5sb3NzID09IDEgdGhlbiByZXR1cm4gZXZhbHNbaV1cclxuXHJcbnNob3dCZXN0ID0gKGkpIC0+XHJcbiAgaWYgc3RhdGUuYmVzdCA9PSAxIHRoZW4gcmV0dXJuIGJlc3RbaV1cclxuICBpZiBiZXN0W2ldICE9IG1vdmVzW2ldIGFuZCBjYWxjTG9zcyhpKSA+PSAyMCB0aGVuIHJldHVybiBiZXN0W2ldXHJcbiAgcmV0dXJuICcnXHJcblxyXG5tYWtlVGFibGVzID0gLT5cclxuXHJcbiAgdGJvZHlwZ24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BnbkhlYWRlcnMgdGJvZHlcIilcclxuICB0Ym9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2hlc3NUYWJsZSB0Ym9keVwiKVxyXG5cclxuICB0Ym9keXBnbi5pbm5lckhUTUwgPSBcIlwiXHJcbiAgdGJvZHkuaW5uZXJIVE1MID0gXCJcIlxyXG5cclxuICBrZXlzID0gW11cclxuICBmb3IgW2tleSwgdmFsdWVdIGluIFsuLi5wYXJhbXMuZW50cmllcygpXVxyXG4gICAga2V5cy5wdXNoIGtleSBcclxuXHJcbiAgZm9yIGtleSBpbiBrZXlzXHJcbiAgICBpZiBrZXkgaW4gJ21vdmUgZXZhbCBiZXN0Jy5zcGxpdCAnICcgdGhlbiBjb250aW51ZVxyXG4gICAgdHIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50IFwidHJcIlxyXG4gICAgYWRkIHRyLCBrZXksICdyaWdodCdcclxuICAgIGlmIGtleSA9PSAnTGluaydcclxuICAgICAgYWRkTGluayB0ciwgZ2V0UGFyYW0oa2V5KSwgXCJMaW5rXCIsICdsZWZ0J1xyXG4gICAgZWxzZVxyXG4gICAgICBhZGQgdHIsIGdldFBhcmFtKGtleSkucmVwbGFjZUFsbChcIl9cIixcIiBcIiksICdsZWZ0J1xyXG4gICAgdGJvZHlwZ24uYXBwZW5kQ2hpbGQgdHJcclxuXHJcbiAgbW92ZXMgPSBnZXRQYXJhbShcIm1vdmVcIikubWFwIGZpZ3VyaW5lXHJcbiAgZXZhbHMgPSBnZXRQYXJhbShcImV2YWxcIikubWFwIHBhcnNlRmxvYXRcclxuICBiZXN0ID0gZ2V0UGFyYW0oXCJiZXN0XCIpLm1hcCBmaWd1cmluZVxyXG5cclxuICBlY2hvIG1vdmVzXHJcbiAgZWNobyBldmFsc1xyXG4gIGVjaG8gYmVzdFxyXG5cclxuICAjIEZ5bGwgaSB0YWJlbGxlblxyXG4gIGZvciBpIGluIFswLi4ubW92ZXMubGVuZ3RoXSBieSAyXHJcbiAgICB0ciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQgXCJ0clwiXHJcbiAgICAjaWYgaT09MCB0aGVuIGNvbnRpbnVlXHJcbiAgICBhZGQgdHIsIHNob3dCZXN0IGlcclxuICAgIGFkZCB0ciwgc2hvd0xvc3MgaVxyXG4gICAgYWRkIHRyLCBtb3Zlc1tpXVxyXG5cclxuICAgIGFkZCB0ciwgKGkgLy8gMikgKyAxLCAnY2VudGVyJ1xyXG5cclxuICAgIGFkZCB0ciwgbW92ZXNbaSsxXSwgJ2xlZnQnXHJcbiAgICBhZGQgdHIsIHNob3dMb3NzKGkrMSksICdsZWZ0J1xyXG4gICAgYWRkIHRyLCBzaG93QmVzdChpKzEpLCAnbGVmdCdcclxuXHJcbiAgICB0Ym9keS5hcHBlbmRDaGlsZCB0clxyXG5cclxud2luZG93Lm9ubG9hZCA9IC0+XHJcbiAgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh3aW5kb3cubG9jYXRpb24uc2VhcmNoKVxyXG4gIG1ha2VUYWJsZXMoKVxyXG5cclxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lciAna2V5ZG93bicsIChldmVudCkgLT5cclxuICBlY2hvIFwiVGFuZ2VudCBuZWR0cnlja3Q6XCIsIGV2ZW50LmtleVxyXG4gIGlmIGV2ZW50LmtleSA9PSAnbCdcclxuICAgIHN0YXRlLmxldHRlciA9IDEgLSBzdGF0ZS5sZXR0ZXJcclxuICAgIG1ha2VUYWJsZXMoKVxyXG5cclxuICBpZiBldmVudC5rZXkgPT0gJ2QnXHJcbiAgICBzdGF0ZS5sb3NzID0gMSAtIHN0YXRlLmxvc3NcclxuICAgIHN0YXRlLmJlc3QgPSAxIC0gc3RhdGUuYmVzdFxyXG4gICAgbWFrZVRhYmxlcygpXHJcbiJdfQ==
//# sourceURL=c:\github\2025\012-ChessViewer\coffee\analyze.coffee